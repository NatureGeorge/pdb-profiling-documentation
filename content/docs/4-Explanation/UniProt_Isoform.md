---
title: Explanation of UniProt Isoform
linktitle: UniProt Isoform
type: book
date: "2020-11-11T00:00:00+01:00"
# Prev/next pager order (if `docs_section_pager` enabled in `params.toml`)
weight: 6
authors:
  - admin
---

<style>
table.dataframe {
    display: block;
    overflow-x: auto;
    white-space: nowrap;
    overflow-y: auto;
    height: 200px;
}
</style>

> This section explains why does `pdb-profiling` implement SIFTS's `api/mappings/all_isoforms/` API that mapped with all the available alternative products of a UniProt Entry in the `Selection` pipeline.

## From the point of transcript mapping

Let's first talk about the procedure of mapping sites.

There are two problems in mapping genomic sites to transcriptional sites and from transcriptional sites to protein sites:

1. Because of the huge amount of genomic data resources, mapping sites need a lot of computing resources although it is simple in logic and computation
2. Genomic identifiers, transcriptional identifiers and protein identifiers can be updated, and there are often large updates on ID identifiers and specific sites

Fortunately, these levels of work are contracted out by institutions such as NCBI and EBI. They are the storage and update site of data resources, and they have sufficient computing resources and funds to complete these tasks conveniently and well. When obtaining the mutation related data of a specific reference genome, the data provider will also give the sites mapped to the transcripts or alternative products of proteins (usually using ensemble gene / transcript / protein or RefSeq nucleotide / transcript / protein).

{{% callout note %}}
If the original mutation data do not give specific protein sites, there are also a large number of tools for transformation, which will not be repeated here.
{{% /callout %}}

In the study of proteins, the data resource of `UniProt-KB` is basically indispensable, which assigns specific identifiers to each gene of a large number of species (i.e. UniProt Accession / Entry: P21359). At the same time, a large number of entries are identified by specialists (UniProt Entries that are identified will be marked as `reviewed`, otherwise `unreviewed`). Entries not reviewed are generally predicted by computational methods based on homology and other methods, and are not generally used.

It is worth noting that `UniProt-KB` takes the phenomenon of alternative splicing at the transcriptional level into account. Therefore, under the UniProt Entries with alternative products, `UniProt-KB` also provides suffixes for isoform(e.g `P21359-1, P21359-2, P21359-3, P21359-4, P21359-5`). These alternative products are different in sequence, so the corresponding complete protein structure may be different.

{{% callout note %}}

1. *Whenever possible, all the protein products encoded by one gene in a given species are described in a single UniProtKB/Swiss-Prot entry, including isoforms generated by alternative splicing, alternative promoter usage, and alternative translation initiation. However, some alternative splicing isoforms derived from the same gene share only a few exons, if any at all, the same for some 'trans-splicing' events. In these cases, the divergence is obviously too important to merge all protein sequences into a single entry and the isoforms have to be described in separate 'external' entries.* (Excerpt from [here](https://www.uniprot.org/help/canonical_and_isoforms))
2. *When alternative protein sequences differ significantly, we (refer to UniProt-KB) create separate entries and list all isoforms in each of them. Consequently, isoforms produced from a single gene listed in one entry may have identifiers derived from different primary accession numbers. (i.e. (P42166, P42167), (Q5JWF2, P63092))* (Excerpt from [here](https://www.uniprot.org/help/alternative_products))

{{% /callout %}}

Among the isoforms of a reviewed UniProt Entry, the `UniProt-KB` will select an isofrom as the canonical isoform to represent that UniProt Entry. Usually the longest one, but could be other cases. The selected canonical isoform will not display its specific isoform suffix in `UniProt-KB` by default. For instance, the canonical isoform of `P21359` is `P21359-1` and in `UniProt-KB`, `P21359` generally means `P21359-1`.

{{% callout note %}}

* *The so-called 'canonical' sequence is the most prevalent sequence and/or the most similar sequence among orthologous species. All positional information in the entry refers to it.* (Excerpt from [here](https://www.uniprot.org/help/alternative_products))
* `UniProt-KB` uses `VAR_032459` and so on (VAR_SEQ) to represent the difference between the sequence and canonical sequence of each alternative products.

{{% /callout %}}

As the holder of `UniProt-KB` and `Ensemble`, EBI matches `Ensembl` with `UniProt` Entries, and accurately matches those UniProt isoforms of the reviewed UniProt entries to the specific corresponding Ensembl isoform. At the same time, it cooperates with NCBI to match the 'RefSeq' resources. Here are the examples:

```python
# Ensembl
ENST00000356175; ENSP00000348498; ENSG00000196712 [P21359-2]
ENST00000358273; ENSP00000351015; ENSG00000196712 [P21359-1]
ENST00000431387; ENSP00000412921; ENSG00000196712 [P21359-5]
ENST00000487476; ENSP00000491589; ENSG00000196712 [P21359-3]
# RefSeq
NP_000258.1, NM_000267.3 [P21359-2]
NP_001035957.1, NM_001042492.2 [P21359-1]
NP_001121619.1, NM_001128147.2 [P21359-5]
```

{{% callout note %}}
Not all reviewed UniProt Entries have alternative products.
{{% /callout %}}

{{% callout warning %}}
For those transcripts mapped with reviewed UniProt Entries but not assigned with isoform suffix, it could probably result from the sequence conflict. Here is an example:
{{% /callout %}}

`NM_001304360.1, NP_001291289.1` mapped with `Q9C0B2` but with non-identical sequence.

```python
Q9C0B2 1500:
FDPRHRE----------EAEELRPILVTLDYIQFDTDTPAPPATRELQVGCIRTTQPSPKK--------------------P---------------------D----HPLMVSALLQLRGDVKETY...
NP_001291289.1 1500:
FDPRHREASSRPGPLSPEAEELRPILVTLDYIQFDTDTPAPPATRELQVGCIRTTQPSPKKTVEFSIDSVASLQHKGFSIEPSRGSVERGQTKTISISWVPPADFDPDHPLMVSALLQLRGDVKETY...
```

Meanwhile, it is noteworthy that some of the conflict(s), variant(s) and/or posttranslational modification(s) are isoform-specific. (i.e P08631, isoform-specific PTM / Processing Features)

> In most cases, this type of annotations are described in the specific subsection, positions being provided with respect to the canonical sequence. However, some variations may be isoform-specific, i.e. the amino acids involved are not present in the canonical sequence. These variations are then described in the 'Alternative products' section and the position(s) refer to the sequence of the actual isoform. (Excerpt from [here](https://www.uniprot.org/help/alternative_products))

### Isoform-Specific Segments

Let's dive into the details of isoform-specific segments. Here is the script that use `pdb-profiling` to get isoform-specific segments/ranges of each query UniProt accession/entry: (in `iso_range` column) 


```python
from pdb_profiling.processors import UniProts, Identifier

demo_unps = (
        'A4UGR9', 'P01116', 'P08631', 'P21359',
        'P63092', 'P68871', 'P85299', 'Q13510',
        'Q5JWF2', 'Q5VST9', 'Q7Z7G8', 'Q8N309',
        'Q8TBY8', 'Q9NTW7', 'Q9NZC2')

alt_seq_df = UniProts.fetch_VAR_SEQ_from_localDB(demo_unps).result()
iso_df = Identifier.query_from_localDB_with_unps(demo_unps, 'ALTERNATIVE_PRODUCTS').result()

alt_seq_dict = alt_seq_df[alt_seq_df.AltID.ne('')][["AltID", "AltLen", "AltRange"]].to_dict("list")
iso_df["iso_range"] = iso_df.sequence.apply(
  lambda x: UniProts.get_affected_interval(UniProts.get_alt_interval_base(x, alt_seq_dict)) if not isinstance(x, float) else x)

iso_df[~iso_df.iso_range.isnull()]
```

<details>
  <summary>Click to view dataframe</summary>
  <table class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>accession</th>
        <th>else_iso</th>
        <th>isoform</th>
        <th>name</th>
        <th>sequence</th>
        <th>sequenceStatus</th>
        <th>synonyms</th>
        <th>alt_range</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>1</th>
        <td>Q5VST9</td>
        <td>NaN</td>
        <td>Q5VST9-2</td>
        <td>2</td>
        <td>[VSP_018436]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(5753, 5754)]</td>
      </tr>
      <tr>
        <th>2</th>
        <td>Q5VST9</td>
        <td>NaN</td>
        <td>Q5VST9-3</td>
        <td>3</td>
        <td>[VSP_018437, VSP_018438]</td>
        <td>described</td>
        <td>unc-89-like</td>
        <td>[(6221, 6620)]</td>
      </tr>
      <tr>
        <th>3</th>
        <td>Q5VST9</td>
        <td>NaN</td>
        <td>Q5VST9-5</td>
        <td>4</td>
        <td>[VSP_020086, VSP_020087]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(3888, 3911)]</td>
      </tr>
      <tr>
        <th>4</th>
        <td>Q5VST9</td>
        <td>NaN</td>
        <td>Q5VST9-6</td>
        <td>5</td>
        <td>[VSP_026970]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(3886, 4401)]</td>
      </tr>
      <tr>
        <th>6</th>
        <td>Q5JWF2</td>
        <td>NaN</td>
        <td>Q5JWF2-2</td>
        <td>XLas-2</td>
        <td>[VSP_052174]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(714, 715)]</td>
      </tr>
      <tr>
        <th>7</th>
        <td>Q5JWF2</td>
        <td>NaN</td>
        <td>Q5JWF2-3</td>
        <td>XLas-3</td>
        <td>[VSP_052173, VSP_052175]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(691, 752)]</td>
      </tr>
      <tr>
        <th>15</th>
        <td>P21359</td>
        <td>NaN</td>
        <td>P21359-3</td>
        <td>3</td>
        <td>[VSP_001629, VSP_001630]</td>
        <td>described</td>
        <td>None</td>
        <td>[(548, 551)]</td>
      </tr>
      <tr>
        <th>16</th>
        <td>P21359</td>
        <td>NaN</td>
        <td>P21359-4</td>
        <td>4</td>
        <td>[VSP_001631, VSP_001632]</td>
        <td>described</td>
        <td>None</td>
        <td>[(1591, 1598)]</td>
      </tr>
      <tr>
        <th>17</th>
        <td>P21359</td>
        <td>NaN</td>
        <td>P21359-5</td>
        <td>5</td>
        <td>[VSP_043467, VSP_043468]</td>
        <td>described</td>
        <td>None</td>
        <td>[(574, 593)]</td>
      </tr>
      <tr>
        <th>18</th>
        <td>P21359</td>
        <td>NaN</td>
        <td>P21359-6</td>
        <td>6</td>
        <td>[VSP_001628, VSP_053587]</td>
        <td>described</td>
        <td>None</td>
        <td>[(2771, 2789)]</td>
      </tr>
      <tr>
        <th>20</th>
        <td>P63092</td>
        <td>[P04895-2]</td>
        <td>P63092-2</td>
        <td>Gnas-2</td>
        <td>[VSP_001833, VSP_001834]</td>
        <td>described</td>
        <td>[Alpha-S1, GNASs, Alpha-S-short]</td>
        <td>[(71, 72)]</td>
      </tr>
      <tr>
        <th>21</th>
        <td>P63092</td>
        <td>NaN</td>
        <td>P63092-3</td>
        <td>3</td>
        <td>[VSP_026616, VSP_026617]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(71, 71)]</td>
      </tr>
      <tr>
        <th>26</th>
        <td>P63092</td>
        <td>NaN</td>
        <td>P63092-4</td>
        <td>4</td>
        <td>[VSP_047325]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(86, 87)]</td>
      </tr>
      <tr>
        <th>32</th>
        <td>P85299</td>
        <td>[Q9NSG0-8]</td>
        <td>P85299-2</td>
        <td>2</td>
        <td>[VSP_001646, VSP_001648]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(1, 6)]</td>
      </tr>
      <tr>
        <th>35</th>
        <td>P85299</td>
        <td>NaN</td>
        <td>P85299-5</td>
        <td>5</td>
        <td>[VSP_045883]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(1, 28)]</td>
      </tr>
      <tr>
        <th>37</th>
        <td>Q13510</td>
        <td>NaN</td>
        <td>Q13510-2</td>
        <td>2</td>
        <td>[VSP_037504]</td>
        <td>described</td>
        <td>None</td>
        <td>[(1, 42)]</td>
      </tr>
      <tr>
        <th>38</th>
        <td>Q13510</td>
        <td>NaN</td>
        <td>Q13510-3</td>
        <td>3</td>
        <td>[VSP_037504, VSP_046284, VSP_046285]</td>
        <td>described</td>
        <td>None</td>
        <td>[(1, 42), (58, 65)]</td>
      </tr>
      <tr>
        <th>41</th>
        <td>Q8N309</td>
        <td>NaN</td>
        <td>Q8N309-3</td>
        <td>3</td>
        <td>[VSP_029636, VSP_029637]</td>
        <td>described</td>
        <td>None</td>
        <td>[(36, 92)]</td>
      </tr>
      <tr>
        <th>43</th>
        <td>P01116</td>
        <td>[P01118-1]</td>
        <td>P01116-2</td>
        <td>2B</td>
        <td>[VSP_011140, VSP_011141]</td>
        <td>described</td>
        <td>K-Ras4B</td>
        <td>[(151, 153), (165, 188)]</td>
      </tr>
      <tr>
        <th>45</th>
        <td>Q9NZC2</td>
        <td>NaN</td>
        <td>Q9NZC2-2</td>
        <td>2</td>
        <td>[VSP_010792]</td>
        <td>described</td>
        <td>TREM-2V</td>
        <td>[(162, 219)]</td>
      </tr>
      <tr>
        <th>46</th>
        <td>Q9NZC2</td>
        <td>NaN</td>
        <td>Q9NZC2-3</td>
        <td>3</td>
        <td>[VSP_010793]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(162, 222)]</td>
      </tr>
      <tr>
        <th>48</th>
        <td>Q7Z7G8</td>
        <td>NaN</td>
        <td>Q7Z7G8-2</td>
        <td>2</td>
        <td>[VSP_009408]</td>
        <td>described</td>
        <td>2A</td>
        <td>[(1386, 1408)]</td>
      </tr>
      <tr>
        <th>49</th>
        <td>Q7Z7G8</td>
        <td>NaN</td>
        <td>Q7Z7G8-3</td>
        <td>3</td>
        <td>[VSP_009409, VSP_009410]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(1386, 1427)]</td>
      </tr>
      <tr>
        <th>50</th>
        <td>Q7Z7G8</td>
        <td>NaN</td>
        <td>Q7Z7G8-4</td>
        <td>4</td>
        <td>[VSP_009406, VSP_009407]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(839, 863)]</td>
      </tr>
      <tr>
        <th>51</th>
        <td>Q7Z7G8</td>
        <td>NaN</td>
        <td>Q7Z7G8-5</td>
        <td>5</td>
        <td>[VSP_009404, VSP_009405]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(403, 415)]</td>
      </tr>
      <tr>
        <th>54</th>
        <td>Q9NTW7</td>
        <td>NaN</td>
        <td>Q9NTW7-2</td>
        <td>4</td>
        <td>[VSP_007285, VSP_007286]</td>
        <td>described</td>
        <td>ZNF338</td>
        <td>[(1, 35)]</td>
      </tr>
      <tr>
        <th>55</th>
        <td>Q9NTW7</td>
        <td>NaN</td>
        <td>Q9NTW7-3</td>
        <td>5</td>
        <td>[VSP_038213, VSP_038214]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(411, 415)]</td>
      </tr>
      <tr>
        <th>56</th>
        <td>Q9NTW7</td>
        <td>NaN</td>
        <td>Q9NTW7-4</td>
        <td>6</td>
        <td>[VSP_046896, VSP_046897, VSP_046898]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(16, 16), (255, 679)]</td>
      </tr>
      <tr>
        <th>57</th>
        <td>Q9NTW7</td>
        <td>NaN</td>
        <td>Q9NTW7-5</td>
        <td>1</td>
        <td>[VSP_046897, VSP_046898]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(257, 681)]</td>
      </tr>
      <tr>
        <th>58</th>
        <td>Q9NTW7</td>
        <td>NaN</td>
        <td>Q9NTW7-6</td>
        <td>2</td>
        <td>[VSP_060092, VSP_046897, VSP_046898]</td>
        <td>described</td>
        <td>NaN</td>
        <td>[(203, 627)]</td>
      </tr>
      <tr>
        <th>60</th>
        <td>Q8TBY8</td>
        <td>NaN</td>
        <td>Q8TBY8-1</td>
        <td>1</td>
        <td>[VSP_060105, VSP_060108]</td>
        <td>described</td>
        <td>None</td>
        <td>[(481, 486), (1009, 1022)]</td>
      </tr>
      <tr>
        <th>62</th>
        <td>Q8TBY8</td>
        <td>NaN</td>
        <td>Q8TBY8-4</td>
        <td>4</td>
        <td>[VSP_060104, VSP_060107]</td>
        <td>described</td>
        <td>None</td>
        <td>[(778, 798)]</td>
      </tr>
      <tr>
        <th>65</th>
        <td>A4UGR9</td>
        <td>NaN</td>
        <td>A4UGR9-3</td>
        <td>3</td>
        <td>[VSP_030847, VSP_030848]</td>
        <td>described</td>
        <td>None</td>
        <td>[(3344, 3345)]</td>
      </tr>
      <tr>
        <th>66</th>
        <td>A4UGR9</td>
        <td>NaN</td>
        <td>A4UGR9-4</td>
        <td>4</td>
        <td>[VSP_035717, VSP_035719, VSP_035720]</td>
        <td>described</td>
        <td>None</td>
        <td>[(1, 176), (393, 938)]</td>
      </tr>
      <tr>
        <th>67</th>
        <td>A4UGR9</td>
        <td>NaN</td>
        <td>A4UGR9-5</td>
        <td>5</td>
        <td>[VSP_035719, VSP_035720]</td>
        <td>described</td>
        <td>None</td>
        <td>[(218, 763)]</td>
      </tr>
      <tr>
        <th>68</th>
        <td>A4UGR9</td>
        <td>NaN</td>
        <td>A4UGR9-6</td>
        <td>6</td>
        <td>[VSP_035717, VSP_035718, VSP_035719, VSP_035720]</td>
        <td>described</td>
        <td>None</td>
        <td>[(1, 176), (188, 221), (426, 971)]</td>
      </tr>
      <tr>
        <th>69</th>
        <td>A4UGR9</td>
        <td>NaN</td>
        <td>A4UGR9-7</td>
        <td>7</td>
        <td>[VSP_030846, VSP_035719, VSP_035720]</td>
        <td>described</td>
        <td>None</td>
        <td>[(171, 716)]</td>
      </tr>
      <tr>
        <th>70</th>
        <td>A4UGR9</td>
        <td>NaN</td>
        <td>A4UGR9-8</td>
        <td>8</td>
        <td>[VSP_035717]</td>
        <td>described</td>
        <td>None</td>
        <td>[(1, 176)]</td>
      </tr>
    </tbody>
  </table>
</details>

To explains the content in the `iso_range`, let's take `[(1, 176), (188, 221), (426, 971)]` (A4UGR9-6) as an example. As the below info provided by `UniProt-KB` shows, there exists four kinds of difference between the canonical sequence and the isoform 6.

```txt
The sequence of this isoform differs from the canonical sequence as follows:
     1-1: M → MFPMQKGSLN...KGKETSFDKM
     13-13: A → AVFSTDQAQILRLHLHPKLTKTPKNSLKSSTYIS
     218-771: TESEYEETFK...LEEVDRGDVK → KLLLQDKEIC...KRNRCYSDTE
     772-3374: Missing.
```

And after mapping the start index and end index of these alternative segments to the isoform, the result would be `[(1, 176), (188, 221), (426, 971)]`.

```txt
Following sequence segments are isoform-specific and not appear in the canonical sequence:
     1   MFPMQKGSLNLLRQKWESCDY...KGKETSFDKM 176
     188 AVFSTDQAQILRLHLHPKLTKTPKNSLKSSTYIS 221
     426 KLLLQDKEICILCQKTVYPME...KRNRCYSDTE 971
     END
```

Noted that the last segment is a missing segment, so this segment would not appear in `[(1, 176), (188, 221), (426, 971)]`.

It is not surprising that some of the conflict(s), variant(s) and/or posttranslational modification(s) and so on would fall into these segments.

When we focus on the distribution of the isoform-specific-segments-length of the non-canonical isoforms (exclude external isoforms) shown in above table, we can find this:

* Scatter Plot

{{< chart data="unp_iso_scatter" >}}

* Bar Plot

{{< chart data="unp_iso_bar_num" >}}

* Bar Plot (ratio)

{{< chart data="unp_iso_bar_ratio" >}}

---

We can see from the above that it is necessary to consider isoform mapping in order to perform accurate site mapping.

{{% callout note %}}

For more details and explanations:

* <https://www.uniprot.org/help/canonical_and_isoforms>
* <https://www.uniprot.org/help/alternative_products>
* <https://www.uniprot.org/help/var_seq>

{{% /callout %}}


## From the point of the best-mapped isoform of a PDB Entity